// =================================================================
// --- BLOCO 2: MENU PRINCIPAL (ATUALIZADO PARA STATUS REPORT) ---
// =================================================================

function onOpen() {
  SpreadsheetApp.getUi()
    .createMenu('ðŸš€ Orquestrador Geral')
    .addItem('ðŸ”„ 1. Executar CICLO COMPLETO (Tudo)', 'executarCicloCompleto')
    .addSeparator()
    .addItem('ðŸ“¦ 2. Processar Materiais (Remoto)', 'processarMateriaisRemoto')
    .addItem('ðŸ’Š 3. Processar Medicamentos (Remoto)', 'processarMedicamentosRemoto')
    .addItem('ðŸ“Š 4. Apenas Compilar Dados (Local)', 'compilarDadosLocal') 
    .addSeparator()
    .addItem('ðŸ“§ 5. Enviar RelatÃ³rio de Status (E-mail)', 'enviarRelatorioGerencial')
    // --- SUBMENU: DISTRIBUIÃ‡ÃƒO ---
    .addSubMenu(SpreadsheetApp.getUi().createMenu('ðŸ‘¥ 6. Distribuir para Equipe')
        .addItem('âœ… Atualizar TODOS (Completo)', 'atualizarTodos')
        .addSeparator()
        .addItem('ðŸ‘¤ Bianca', 'atualizarBianca')
        .addItem('ðŸ‘¤ Katia', 'atualizarKatia')
        .addItem('ðŸ‘¤ Leonardo', 'atualizarLeonardo')
        .addItem('ðŸ‘¤ Moises', 'atualizarMoises')
        .addItem('ðŸ‘¤ Rafaelle', 'atualizarRafaelle')
        .addItem('ðŸ‘¤ Luciana', 'atualizarLuciana'))
    .addItem('ðŸ” 7. Localizar Item (Qual Planejador?)', 'localizarItemNoPainelEquipe')
    .addSeparator()
    .addSubMenu(SpreadsheetApp.getUi().createMenu('ðŸ§  InteligÃªncia & AutomaÃ§Ã£o')
        .addItem('ðŸ“¸ Salvar Snapshot (HistÃ³rico BI)', 'salvarSnapshotHistorico')
        .addItem('ðŸ“¨ Gerar Rascunhos de CobranÃ§a (Gmail)', 'gerarRascunhosCobranca'))
    .addSeparator()
    .addSubMenu(SpreadsheetApp.getUi().createMenu('ðŸ’¼ RelatÃ³rios Gerenciais (Chefia)')
        .addItem('ðŸ† Ranking de Fornecedores (Performance)', 'gerarRelatorioPerformanceFornecedores')
        .addItem('ðŸ’° Panorama Financeiro (Executivo)', 'gerarRelatorioFinanceiroExecutivo'))
    .addSeparator()
    .addSubMenu(SpreadsheetApp.getUi().createMenu('ðŸ“ˆ GestÃ£o de Estoque')
        .addItem('ðŸ”„ Sincronizar Cont.Estoque (Remoto)', 'sincronizarControleEstoque')
        .addItem('ðŸ“Š Dashboard de Status', 'gerarDashboardStatus'))
    .addSeparator()
    .addSubMenu(SpreadsheetApp.getUi().createMenu('ðŸ“‘ RelatÃ³rios Operacionais')
        // MUDANÃ‡A AQUI:
        .addItem('Atualizar Status Report', 'processarMutirao') 
        .addItem('Rel. Validade de Atas (Filtrar L1/M1)', 'gerarRelatorioValidadeAtas')
        .addItem('Rel. Valor ResÃ­duo 10%', 'gerarRelatorioResiduo10')
        .addItem('Rel. Itens em atraso >10', 'gerarRelatorioAtrasos')
        .addItem('RelatÃ³rios Financeiros (Resumo)', 'atualizarResumo')
        .addItem('Processar Restos a Pagar', 'processarRestosAPagar')
        .addItem('Buscar Dados para Guia LISTA', 'buscarDadosLista'))
    .addSeparator()
    .addSubMenu(SpreadsheetApp.getUi().createMenu('ðŸ”— SincronizaÃ§Ã£o Externa')
        .addItem('1. Analisar DivergÃªncias', 'buscarEmpenhosCodigosErrados')
        .addItem('2. Enviar Itens Faltantes', 'sincronizarEmpenhosNaExterna')
        .addItem('3. Reparar Dados Vazios', 'repararDadosFaltantesNaExterna'))
    .addSeparator()
    .addItem('ðŸ“„ Gerar PDF por Status', 'abrirMenuGerarPDF') 
    .addItem('ðŸ§¹ Limpar Visual (Ocultar Abas TÃ©cnicas)', 'ocultarAbasTecnicas')
    .addToUi();
}
